["Brandeis Consulting Calculation Views Grundlagen Calculation Views vom Typ Cube ","Brandeis Consulting Cube Calculation Views – Beispiel Projektauswertung Fragestellung für eine Projektauswertung: • Wie viele Aufgaben und Aufwände liegen bei den einzelnen Mitarbeitern? • Welche IST-Aufwände sind nach Projekt angefallen? • Welche PLAN-Aufwände gibt es in den nächsten zwei Wochen? Dimensionen der Auswertung: • Bearbeiter (-> Team) • Projekt • Status • Zeit Cube Views - Kennzahlen modellieren TASKS USERS PROJECTS TIME ","Brandeis Consulting Struktur von Cube Views • Semantikknoten im Cube • Spalten als Merkmal oder Kennzahl definieren • Währungsbezug definieren, etc. • Zwei Varianten von Cube Views • Aggregation • Star Join • Join von Faktentabelle mit mehreren Dimensionen • Letzte Operation ist immer Aggregation bei Cube View => • Ergebnis wird auf der von außen angeforderten Aufrissebene aggregiert (Spalten in Select-Klausel + Filterbedingungen) • Dynamische Aggregationseben Cube Views - Kennzahlen modellieren Semantics SOURCE AGGREGATION ","Brandeis Consulting Aggregationsknoten • Definiere die zu aggregierenden Spalten • Aggregationsfunktion definieren • Summe • Maximum, Minimum • Count • Durchschnitt, Varianz, Standardabweichung • Aggregation leer => • Spalte wird Teil der Aggregationsebene • Aggregationsebene bei Ausführung wird dynamisch bestimmt => • Genaue Steuerung mit Keep Flag möglich Cube Views - Kennzahlen modellieren ","Brandeis Consulting Berechnete Spalten, Kennzahlen und Merkmale • Berechnete Spalten definieren • Syntax: SQL • Formeln • Zeichenverarbeitung • Datumsverarbeitung • Definition in folgenden Knoten: • Aggregation, Star Join • Projektion • Join (nur Equi), Union, Set Minus, Intersect • Achtung: Reihenfolge Berechnung/Aggregation • Aggregationsknoten: Berechnung nach der Aggregation • Projektionsknoten: Berechnung auf Zeilenebene • Oberster Knoten in Cube (Aggregation/Star Join): Berechnete Spalte kann als Merkmal oder Kennzahl definiert werden Cube Views - Kennzahlen modellieren Bsp.: Aufgaben Restaufwand = Planaufwand – Ist-Aufwand Kosten = Planaufwand * Stückkosten Anzeigename = Nachname, Vorname Fällig in Tagen: DUE_DATE – TODAY Datentyp konvertieren (Char -> INT) Kalendarische Merkmale extrahieren ","Brandeis Consulting Beispiele für SQL-Funktionen Cube Views - Kennzahlen modellieren Bereich Use-Case / SQL-Funktion Beispiel Zeichenketten Konkatenierung: CONCAT, || (Pipe- Operator) Mit Zeichen auffüllen LPAD, RPAD Teilkette: SUBSTR Datum Monat, Jahr extrahieren: EXTRACT_MONTH, EXTRACT_YEAR Tage zwischen zwei Datümern: DAYS_BETWEEN ADD_DAYS Fallunterscheidung CASE-Statement CASE WHEN \"DUE_DATE\" < '01.01.2018' AND ( \"STATUS\" NOT IN (5,6) ) THEN 1 ELSE 0 END ","Brandeis Consulting Expression Editor für berechnete Spalten • Operanden • Spalten • Berechnete (oder eingeschränkte) Spalten • Parameter, Session Variablen • Funktionen • Konvertierung • Datumsfunktionen • Mathematische Funktionen • Zeichenketten • Logische Operationen • Validate Syntax => Syntaktische Korrektheit prüfen Cube Views - Kennzahlen modellieren ","Brandeis Consulting Cube Calculation Views – Berechnete Kennzahlen Cube Views - Kennzahlen modellieren • Beispiel und Übung: • Cube View auf Tabelle TASKS • Berechnete Kennzahlen • Berechnete Merkmale ","Brandeis Consulting Cube Calculation Views – Eingeschränkte Kennzahlen • Einschränken einer Kennzahl auf bestimmte Merkmalsausprägungen • Definition: • Basiskennzahl • Einschränkungen für Merkmale • Selektionsmöglichkeit: • Einzelne Werte oder Wertebereiche • Filterung auf mehrere Merkmale möglich • SQL-Ausdrücke zur Filterung • Definition in Aggregationsknoten oder in Star Join Cube Views - Kennzahlen modellieren Bsp.: IST-Aufwand der Aufgaben in Bearbeitung Wenn STATUS = 3 => IST-Aufwand, sonst 0 PLAN-Aufwand der offenen Aufgaben => STATUS = 1,2 ","Brandeis Consulting Cube Calculation Views – Zähler • Zählen von Sätzen und Merkmalsausprägungen • Definition nur im Cube View in letztem Knoten unterhalb Semantics (Aggregation, Star Join) • Entspricht „Count Distinct“ im SQL Cube Views - Kennzahlen modellieren Bsp.: Anzahl der Aufgaben Anzahl Bearbeiter von Aufgaben ","Brandeis Consulting Cube Calculation Views – Eingeschränkte Kennzahlen Cube Views - Kennzahlen modellieren • Beispiel und Übung: • Cube View auf Tabelle TASKS • Eingeschränkte Kennzahl nach Status und Fälligkeitsdatum • Zähler ","Brandeis Consulting Übung Eingeschränkte Kennzahlen • Öffne Cube CV_C_TASKS_USERS_CALC (letzte Übung berechnete Kennzahlen) • Aggregationsknoten Aggregation -> Reiter Restricted Column -> Add • EFFORT_PROCESS • Base Measure: EFFORT • Selektion: STATUS = 3 • PLANNED_EFFORT_TWO_WEEKS • Base Measure: PLANNED_EFFORT • Selektion: DUE_DATE >= 01.01.2018 and DUE_DATE <= 15.01.2018 Cube Views - Kennzahlen modellieren ","Brandeis Consulting Übung Eingeschränkte Kennzahlen (Forts.) – SQL-Ausdruck • SQL-Ausdruck für PLANNED_EFFORT_TWO_WEEKS • Variation: Verwende SQL-Funktion ADD_DAYS um zweites Datum zu berechnen: ADD_DAYS('01.01.2018‘,14) Cube Views - Kennzahlen modellieren \"DUE_DATE\" >= '01.01.2018' AND \"DUE_DATE\" <= ADD_DAYS('01.01.2018’,14) ","Brandeis Consulting Übung Eingeschränkte Kennzahlen und Zähler (Forts.) – Datenvorschau • Datenvorschau • Einzelsatz => Validierung der Selektion • Auswertung nach Benutzer: Aggregationsebene: Assignee • Auswertung nach Team Cube Views - Kennzahlen modellieren ","Brandeis Consulting Cube Calculation Views – UNION-Knoten Cube Views - Kennzahlen modellieren • Union: Vereinigung von Daten aus zwei oder mehr Datenquellen • Entspricht UNION ALL in Select-Statement • Erlaubt Mapping von Eingangs-/Ausgabespalten • Constant Mapping: Zielspalte mit konstantem Wert je nach Quellknoten versorgen • Anwendungsfall: • Daten zusammenführen: IST, PLAN-Sätze • Mehrere Faktentabellen mit gemeinsamen und unterschiedlichen Merkmalsdimensionen • Kombination aus Aggregation/Union (=> Composite Provider oder Multiprovider im BW) • Weitere Anwendungsfälle: • Kapslung von Knoten => Erweiterbarkeit, Austausch von Knoten in bestehendem Calculation View • Transponieren von Daten UNION PLAN-Sätze IST-Sätze ","Brandeis Consulting Übung Union-Knoten • Neuer Cube CV_C_UNION_TASKS_PROEJCTS • Quellknoten • Projektion P_TASKS • Tabelle TASKS • Alias für ID: TASKID • Projektion P_PROJECTS • Tabelle PROJECTS • Alias für ID: PROJECT • UNION-Knoten • Quellknoten einbinden • Feldmapping • Gemeinsame Merkmale: STATUS, PROJECT • Andere Merkmale werden nur von einem Quellknoten versorgt • Neue Spalte SOURCE: Typ „Constant Mapping“ Cube Views - Kennzahlen modellieren ","Brandeis Consulting Übung Union-Knoten (Forts.) • Spalte SOURCE vom Typ Constant Mapping • Fester Wert je nach Quelle: • P_TASKS -> „TASKS“ • P_PROJECTS -> „PROJECTS“ Cube Views - Kennzahlen modellieren ","Brandeis Consulting Übung Union-Knoten (Forts.) • Datenvorschau: • Achtung: Zeilenlimit 1000 => Wert erhöhen in Preferences • Einzelsatz • Aufriss nach Project oder Status • Mit/ohne Spalte SOURCE Cube Views - Kennzahlen modellieren ","Brandeis Consulting Cube Calculation Views – STAR JOIN Cube Views - Kennzahlen modellieren • Cube View mit STAR JOIN • Oberster Knoten: STAR JOIN • Verknüpft eine Faktentabelle mit mehreren Dimensionstabellen • Aggregiert Kennzahlen • Einbinden Dimension Views als Dimensionstabellen • Sehr gut für multidimensionales Reporting => STAR-Schema • Faktentabelle: Ein Eingangsknoten für Star Join • Flexibles Berechnungsmodell unterhalb => einzelne Quelltabelle oder komplexes Modell • Standard-Join-Typ: • Equi Join • Referential Join (nur Ausführung der relevanten Joins!) • Maximal eine Verknüpfung vom Typ Right Outer Join • Spezielle Join-Typen: • Temporal Join • Nachlesen von zeitabhängigen Stammdaten • Dimension View muss Gültigkeitsfelder gültig ab (DATEFROM), gültig bis (DATETO) haben • Faktentabelle hat Feld mit Stichtag • Spatial Join ","Brandeis Consulting Übung: STAR JOIN Cube Views - Kennzahlen modellieren • Faktentabelle • TASKS • Dimension Views • CV_DIM_USERS_TEAM • CV_DIM_STATUS_TEXT_SOL (Ordner ch_dimension_views) • Neuer Cube View CV_C_STAR_JOIN_TASKS • Option „With Star Join“ ","Brandeis Consulting Übung: STAR JOIN (Forts.) Cube Views - Kennzahlen modellieren • Einfügen Dimension Views • CV_DIM_USERS_TEAM • CV_DIM_STATUS_TEXT_SOL (Ordner ch_dimension_views) • Modellieren Join-Verknüpfung • Join-Felder • Join-Typ ","Brandeis Consulting Übung: STAR JOIN (Forts.) Cube Views - Kennzahlen modellieren • Einfügen zweiter Dimension View • CV_DIM_USERS_TEAM • Semantics -> Columns: • Private: Felder der Faktentabelle Shared: Felder der Dimension Views ","Brandeis Consulting Keep Flag und Ausnahmeaggregation • Ebene für die Aggregation wird an jedem Knoten während der Laufzeit dynamisch bestimmt und enthält u.a.: • Spalten im Aufriss • Spalten in der Where-Bedingung • Spalten aus Join-Bedingungen, Filter etc. in Folgeknoten • Keep-Flag: Wird im Aggregationsknoten an einer Spalte aktiviert => Diese Spalte wird immer in der Aggregationsebene verwendet, d.h. über diese Spalte wird nicht aggregiert • Kann auch an Projektions-Knoten und anderen Knoten aktiviert werden • Use-Case: • Mehrstufige Aggregation/Ausnahmeaggregation • Berechnung auf Zwischenebene / Berechnung vor Aggregation • Zähler innerhalb von Calculation Views • Aufruf von Cube Views (Steuerung der Aggregation) Cube Views – Keep Flag und Ausnahmeaggregation ","Brandeis Consulting Keep Flag und Ausnahmeaggregation Cube Views – Keep Flag und Ausnahmeaggregation Bsp. Ausnahmeaggregation: - Summiere Aufwände (EFFORT) nach Fälligkeitstag (DUE_DATE) - Bilde Maximum der summierten Aufwände über Projekt oder Bearbeiter Berechnung auf Zwischenebene (Berechnung vor Aggregation) - Kennzahl: Stückzahl nach Material - Kennzahl: Preis pro Material - Aggregiere zunächst Stückzahl auf Ebene Material - Berechne Formel: Stückzahl * Material - Summiere Beträge über alle Materialien ","Brandeis Consulting Keep Flag - Beispiel Cube Views – Keep Flag und Ausnahmeaggregation Project Due_Date Taskid Planned_Effort 1 10.01.2018 355 10 1 10.01.2018 356 20 1 30.12.2017 350 5 2 30.12.2017 340 15 2 30.12.2017 335 10 Project Due_Date Planned_Effort 1 10.01.2018 30 1 30.12.2017 5 2 30.12.2017 25 Project Planned_Effort 1 20 2 15 Einstufige Aggregation auf Project Aggregationsfunktion: Max Zwischenaggregation auf Project, Due_Date (Keep Flag) Aggregationsfunktion: Sum Finale Aggregation auf Project Aggregationsfunktion: Max => Ergibt eine zweistufige Aggregation aus Summe und Maximum Project Planned_Effort 1 30 2 25 ","Brandeis Consulting Rank-Knoten • Gruppiert Datensätze nach Merkmalen • Sortierung innerhalb von Partition • Auswahl der Top N, oder Top % Sätze • Rang - Spalte (Rank Column ): • Rank • Dense Rank • Offset - Definition • Dynamische Partition möglich • Bsp : • Top 3 der am nächsten fälligen Aufgaben pro Mitarbeiter • Top 3 der Aufgaben mit größtem geplanten Aufwand pro Projekt • Top 3 der Mitarbeiter mit größtem Workload (geplante Aufwände) Cube Views - Kennzahlen modellieren ","Brandeis Consulting Rank-Knoten (Beispiel) • Quelltabelle: TASKS mit Filterung auf DUE_DATE >= 01.11.2017 • Partition: ASSIGNEE • Sort Column : DUE_DATE • Top 5 • => Zeige die 5 nächst fälligen Aufgaben pro Mitarbeiter Cube Views - Kennzahlen modellieren ","Brandeis Consulting Rank-Knoten (Übung) • Szenario: • Summiere die geplanten Aufwände (PLANNED_EFFORT) nach Project und Assignee • Zeige pro Projekt die 5 Mitarbeiter mit den größten Aufwänden • Quellknoten: Neuer Aggregations - Knoten mit Tabelle TASKS unterhalb von Rank - Knoten • Rank - Knoten • Partition: PROJECT • Sort Column : PLANNED_EFFORT ( Descending ) • Top 5 • => Pro Projekt werden die 5 größten geplanten Aufwände (je Mitarbeiter) gezeigt Cube Views - Kennzahlen modellieren ","Brandeis Consulting Cube Calculation Views – Key-Takeaway Cube Views - Kennzahlen modellieren • Was sind Cube Calculation Views • Modellierung von Kennzahlen • Berechnete und eingeschränkte Kennzahlen, Zähler • Union • Mehrdimensionale Modellierung (Star Join) • Keep Flag • Rank-Knoten ","Brandeis Consulting Fragen? Cube Views - Kennzahlen modellieren "]
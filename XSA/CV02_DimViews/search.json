["Brandeis Consulting Calculation Views Grundlagen Knotentypen und Modellieren von Dimension Views ","Brandeis Consulting Motivation: Dimensionen für Cubes modellieren Dimension Views und Knotentypen TASKS ASSIGNEE STATUS PROJECTS EFFORT PLANNED _EFFORT Name Team USERS TEAM_TEXT ID Text DUE_DATE M_TIME_DIMENSION Date Week Month Year Quarter ","Brandeis Consulting Modellieren von Dimension Views Typische Aufgaben beim Modellieren von Merkmalen: • Lookup: Relevante Attribute aus anderen Tabellen nachlesen • Beispiel: Status der Aufgabe -> Lese Attribut IS_FINAL aus Tabelle STATUS • Zu welchem Team gehört der Bearbeiter einer Aufgabe? • Dimensionen anreichern mit Attributen aus mehreren Tabellen • Dimension Projekt: Projects, Users, Team_Text • Texte zu Schlüsselwerten ermitteln • Bezeichnung des Status, Name des Teams • Virtuelle Merkmale mit SQL: • Anzeigetext (User, Titel einer Aufgabe + ID) • Formatumwandlung, Verknüpfen von zwei Merkmalen • Logik Dimension Views und Knotentypen ","Brandeis Consulting Projektionsknoten • Projektionsknoten • Analog zu SELECT-Statement auf einer Tabelle • Enthält exakt eine Datenquelle (Vorgängerknoten, Tabelle, Tabellenfunktion, andere HANA-Objekte) • Spalten für Ausgabe auswählen • Alias für Spalten vergeben • Filter definieren • Virtuelle Spalten definieren (SQL-Ausdruck) Dimension Views und Knotentypen ","Brandeis Consulting Datenquellen von Calculation Views • HANA-Tabelle (spalten- und zeilenbasiert) • Calculation View • SQL-View • Tabellenfunktion • (HANA) CDS-Entität (View oder Tabelle) • Remote Source: Virtuelle Tabellen aus externem System (z.B. SDA, SDI) • Datenquelle aus anderem Mandant der HANA (Tabelle, SQL view, Calculation View etc.) • Calculation Views bieten große Flexibilität an erlaubten Datenquellen • Merkregel: Alle Objekte, die auf Datenbankebene definiert sind oder ausgeführt werden und keine Daten ändern • Sowohl lokale Objekte in eigener HANA als auch Remote-Quellen Dimension Views und Knotentypen ","Brandeis Consulting Projektionsknoten – Beispiel und Übung Dimension Views und Knotentypen • Beispiel/Übung: Dimensionview mit Tabelle USERS • Filterung • Virtuelle Spalte „Anzeigename“ • Später: • Erweitere View mit JOIN auf TEAM_TEXT => Ermittle Teamname ","Brandeis Consulting Join-Knoten • Join von zwei oder mehr Datenquellen • Vorgänger-Knoten im View • HANA-Objekte • Zwei Knotentypen: • Equi Join • Einfache JOIN-Bedingung: Immer mit = • Non Equi Join (neu mit Web IDE) • Komplexe JOIN-Bedingung (=, <>, <=, >=) • oder direkt als SQL-Ausdruck modellieren • Begriff: Theta-Join • Kardinalität: Anzahl der zulässigen Treffer pro Satz definieren • Join mit mehr als zwei Datenquellen (Multi Join) (neu mit Web IDE) • Bei Bedarf Reihenfolge der Ausführung festlegen (wichtig bei Kombination von Outer und Inner Join) Dimension Views und Knotentypen ","Brandeis Consulting JOIN-Typen im Vergleich - Standardtypen • Inner JOIN: • Nur Sätze mit erfüllter JOIN-Bedingung (Schnittmenge) • Outer JOIN: • Left: Alle Sätze aus linkem JOIN-Partner, angereichert mit Spalten aus rechtem JOIN-Partner • (Linke Tabelle + Schnittmenge) • Right: Alle Sätze aus rechtem JOIN- Partner, angereichert mit Spalten aus linkem • (Rechte Tabelle + Schnittmenge) • Full: Alle Sätze aus beiden JOIN-Partner • („Vereinigung“ + satzweise Verknüpfung) Dimension Views und Knotentypen ","Brandeis Consulting Spezielle JOIN-Typen bei Calc Views : Referential Join • Referential JOIN: • Modelliert Fremdschlüsselbeziehungen • Ausführung bei Bedarf • Je nach Aufriss/angeforderten Spalten • Wenn Spalten aus Referenztabelle angefordert werden: Ausführung als Inner Join • Keine Spalten aus Referenztabelle: Keine Ausführung • Optimierung der JOIN-Ausführung möglich: • Voraussetzung: Kardinalität n:1, 1:1 • Referentielle Integrität muss durch Entwickler sichergestellt werden, keine automatische Überprüfung! • Analogie: Assoziationen in ABAP CDS Dimension Views und Knotentypen TASKS ID ASSIGNEE USERS ID TEAM Referential JOIN Fremdschlüssel ASSIGNEE Kardinalität: n:1 Referenztabelle ","Brandeis Consulting Spezielle JOIN-Typen bei Calc Views : Referential Join - Neuerungen mit Web IDE • Verhalten in Eclipse: • Linke Tabelle hat Fremdschlüssel • Rechte Tabelle ist Referenztabelle • Neue in Web IDE: • Flexible Definition der Rollen • Einstellung Integrity Constraint: Welche Tabelle hat den Fremdschlüssel • Beispiel: • Tabelle mit Integrity Constraint: TASKS (Kennzahlen + Fremdschlüssel Assignee) => Faktentabelle • Soll immer gelesen werden • Referenztabelle: USERS (Primärschlüssel USER) => Dimension • Nur bei Bedarf Dimension Views und Knotentypen TASKS ID ASSIGNEE USERS ID TEAM Referential JOIN Faktentabelle mit Fremdschlüssel Integrity Constraint: Left Referenztabelle ","Brandeis Consulting Text-JOIN • Nachlesen von Bezeichnungen aus Texttabellen • Unterstützt Mehrsprachige Texte • Filterung gem. Anmeldesprache • Spalte: „SPRAS“ in Texttabelle • Auswahl der Spalte bei Feld Language Column • Ausführung wie Left Outer Join mit Kardinalität n:1 • Ausführung nur bei Bedarf • Wenn kein Text in passender Sprache => NULL Dimension Views und Knotentypen USERS ID TEAM TEAM_TEXT ID TEAM Text Join ","Brandeis Consulting JOIN – Beispiele und Übung Dimension Views und Knotentypen • Beispiel/Übung: • Text-JOIN STATUS und STATUS_TEXT • Übung: • Erweitere View CV_DIM_USERS um JOIN mit Tabelle TEAM_TEXT ","Brandeis Consulting Flag: Dynamic Join • Einsatzszenario: Equi-Join mit mehreren Join-Feldern • Bsp.: Länderhierarchie: Bundesland, Landkreis, Stadt • Flag Dynamic Join • Join wird nur über Spalten ausgeführt, die in Select-Abfrage ausgewählt sind • Daten werden vor Join aggregiert auf angeforderten Spalten • Performance-Optimierung • Use-Case: Anteilsberechnung (Umsatz Filiale / Umsatz gesamt) Dimension Views und Knotentypen Bundesland Landkreis Fallzahl 01 12 100 01 13 20 02 14 30 ","Brandeis Consulting Dynamic Join - Beispiel Dimension Views und Knotentypen Bundesland Landkreis Fallzahl 01 12 10 01 13 25 02 14 30 Bundesland Landkreis Einwohner 01 12 1000 01 13 500 02 14 300 Abfrage auf Ebene Bundesland -> Join wird nach Aggregation ausgeführt: Reduzierte Join-Felder: Bundesland Bundesland Fallzahl 01 35 02 30 Bundesland Einwohner 01 1500 02 300 ","Brandeis Consulting Flag: Optimize Join Column • Join-Ausführung kann je nach Join-Typ und Kardinalität ausgelassen werden, wenn nur Spalten von einem der beiden Join-Partner angefordert sind (Join pruning) • Join pruning wird von HANA automatisch ausgeführt, wenn zulässig • Optimize Join Column: • Spalten der JOIN-Bedingung werden standardmäßig immer abgefragt • Wenn Flag aktiv ist und Join ausgelassen wird => Spalte wird nicht abgefragt Dimension Views und Knotentypen Join-Typ Kardinalität Pruning Left Outer N:1, 1:1 Ja Left Outer N:M, leer Nein Right Outer 1:N, 1:1 Ja Inner alle Nein Referential (Integrity Constraint Left) N:1, 1:1 Ja Referential (Integrity Constraint Right) 1:N, 1:1 Ja Text Join 1:1 Ja ","Brandeis Consulting Grafische Calculation Views – Key-Takeaway Dimension Views und Knotentypen • Modellieren von Dimension Views • Projektions-Knoten, Semantik • Join-Knoten, Text Join • Join-Einstellungen: Dynamic Join, Optimize Join Column ","Brandeis Consulting Fragen? Dimension Views und Knotentypen ","Brandeis Consulting Backup Dimension Views und Knotentypen "]